# 参数估计

在动态系统的状态空间模型中，经常存在未知或不确定的需要与状态一同估计的参数$\theta$。虽然在形式上，我们总是可以将未知参数作为状态的一部分，但在实践中，单独考虑参数估计通常是有用的。

在贝叶斯设置中，估计参数的正确方式是设置参数的先验分布，并将其视为模型中的附加随机变量。当存在未知参数时，状态空间模型变为
$$
\begin{aligned}
\theta &\sim p(\theta)\\
x_0 &\sim p(x_0|\theta)\\
x_k &\sim p(x_k|x_{k-1,},\theta)\\
y_k &\sim p(y_k|x_k,\theta)
\end{aligned}
$$
这个问题的完整贝叶斯解决方案需要计算状态和参数的完整联合后验分布$p(x_{0:T}|y_{1:T})$。不幸的是，计算状态和参数的联合后验比单独计算状态的联合分布更困难。

幸运的是，当使用固定参数$\theta$运行时，贝叶斯滤波算法产生一系列分布$p(y_k|y_{1:k},\theta),k=1,\cdots,T$作为副产品。一旦我们有这些，我们能用如下形式写下参数的边缘后验分布：
$$
p(\theta|y_{1:T}) \propto p(\theta)\prod_{k=1}^Tp(y_k|y_{1:k-1},\theta)
$$
其中为了方便我们定义$p(y_1|y_{1:0},\theta)\triangleq p(y_1|\theta)$。当与平滑分布相结合时，我们可以形成状态和参数的所有边缘联合分布，如下所示：
$$
p(x_k,\theta|y_{1:T}) = p(x_k|y_{1:T},\theta)p(\theta|y_{1:T})
$$
其中$k=1,\cdots,T$，$p(x_k|y_{1:T},\theta)$为在固定模型参数$\theta$下的状态的平滑分布。

虽然我们在这里使用了术语参数估计，但有时可能会出现这样的情况：我们实际上对参数本身的值并不感兴趣，但我们只是不知道它们的值。在这种情况下，正确的贝叶斯方法是对参数进行积分。例如，为了在存在未知参数的情况下计算平滑分布，我们可以从联合分布中积分出参数：
$$
\begin{aligned}
p(x_k|y_{1:T}) &= \int p(x_k,\theta|y_{1:T})d\theta\\
&= \int p(x_k|y_{1:T},\theta)p(\theta|y_{1:T})d\theta
\end{aligned}
$$
